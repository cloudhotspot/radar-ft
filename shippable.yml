language: node_js

node_js:
  - "0.10"

addons:
  firefox: "19.0"

services:
  - selenium

env:
  global:
    - WWW_URL=http://mt-fo-lb-168423950.us-east-1.elb.amazonaws.com:61318
    - secure: xObMoY9T3/bgd8GHdnQGCZVkZgjUcA9La/FKJVLBh6ItyPH39M5C0F30A/66mgej8LdTpi1veKaLKuxK6+lubNhstfuUthRCU1tgKia7w3sZeelmNizZ8lKbVsa1G/K8mbTE1Ar1nBnBXsJJAdJF7BTJKsUgbK5VySLNgm47VMC47JMzYYiDd1QTgSoJuGjItGSut147qDJWtYSpwrXkCAgIV6QmCw5/Gicx+rZ/jNBBhDV1ksDONKmD8Y2eRSwmGKFL/cQ5+JTlFwH77O9D3tRDyh7Z3EstJGbnLoPWDGTki98vvT9vD2WwfhFT3KQ2pstLH+VwUf3b71gUoBJ2XQ==
    # TOKEN is a GitHub token for the subscription triggering the build

install:
  - npm install -g istanbul
  - npm install -g protractor
  - npm install jasmine-reporters@1.0.0

before_script:
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage
  - "export DISPLAY=:99.0"
  - "/etc/init.d/xvfb start"

script:
  - protractor --version
  - protractor conf.js

after_script:
  - "/etc/init.d/xvfb stop"
  - istanbul cover conf.js -- -u tdd
  - istanbul report cobertura --dir  shippable/codecoverage/
